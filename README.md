# TTRPG Character Builder

**TTRPG Character Builder** — это веб-платформа, предназначенная для создания и управления листами персонажей для различных настольно-ролевых игр. Проект нацелен на простоту освоения для новичков и предоставление мощных инструментов для опытных игроков и мастеров (GM).

Основной принцип платформы — модульность и расширяемость, что позволяет легко добавлять поддержку новых игровых систем, а в будущем — и домашние правила (homebrew).

## Текущее состояние проекта: MVP Backend

На данный момент завершен этап **MVP (Минимально жизнеспособного продукта)** для бэкенд-части проекта.

**Реализовано:**
*   **Гибкая архитектура базы данных (PostgreSQL):** Создана универсальная структура, способная хранить правила любой НРИ, не привязываясь к конкретной системе.
*   **Бэкенд на Django & Django REST Framework:** Написан API для управления основными сущностями.
*   **Автоматическая документация API:** Настроена генерация интерактивной документации через `drf-spectacular`, доступная по адресу `/api/docs/`.
*   **Поддержка Daggerheart:** В качестве пилотной системы реализована загрузка базовых правил Daggerheart (классы, происхождения и т.д.) через management-команду.
*   **CI/CD:** Настроен базовый CI-пайплайн через GitHub Actions, включающий проверку качества кода с помощью линтера `flake8` и форматтера `black`.
*   **Полный CRUD для персонажей:** Реализованы API-эндпоинты для создания, просмотра, редактирования и удаления листов персонажей.

## Технологический стек

*   **Backend:** Python 3.11, Django, Django REST Framework
*   **База данных:** PostgreSQL
*   **Frontend:** React (планируется)
*   **Окружение:** Docker, Docker Compose
*   **CI/CD:** GitHub Actions
*   **Инструменты качества кода:** Flake8, Black, pre-commit

## Установка и запуск проекта

Для запуска проекта на локальной машине необходимо иметь установленные **Docker** и **Docker Compose**.

### Пошаговая инструкция

1.  **Клонируйте репозиторий:**
    ```bash
    git clone https://github.com/your-username/ttrpg-character-builder.git
    cd ttrpg-character-builder
    ```

2.  **Создайте файл с переменными окружения:**
    Проект использует файл `.env` для хранения конфигурации. Скопируйте пример:
    ```bash
    cp .env.example .env
    ```
    Вам не нужно менять значения в `.env` для локального запуска, но убедитесь, что `SECRET_KEY` является уникальной и сложной строкой.

3.  **Соберите и запустите Docker-контейнеры:**
    Эта команда скачает необходимые образы, соберет образ для Django-приложения и запустит все в фоновом режиме.
    ```bash
    docker-compose up --build -d
    ```

4.  **Примените миграции базы данных:**
    Эта команда создаст все необходимые таблицы в базе данных PostgreSQL.
    ```bash
    docker-compose exec web python manage.py migrate
    ```

5.  **Создайте суперпользователя:**
    Это необходимо для доступа к админ-панели Django.
    ```bash
    docker-compose exec web python manage.py createsuperuser
    ```
    Следуйте инструкциям в консоли, чтобы задать логин, email и пароль.

6.  **Загрузите начальные данные (сиды):**
    Эта команда наполнит базу данных базовыми правилами для системы Daggerheart.
    ```bash
    docker-compose exec web python manage.py load_system_data data/seeds/daggerheart_1_0.json
    ```

## Настройка инструментов качества кода (локально)

Для поддержания единого стиля кода во всей команде мы используем `pre-commit` хуки, которые автоматически форматируют и проверяют код перед каждым коммитом. **Эту настройку должен выполнить каждый разработчик один раз.**

1.  **Установите `pre-commit`:**
    Если у вас не установлен `pre-commit` глобально, вы можете сделать это с помощью `pip`:
    ```bash
    pip install pre-commit
    ```
    *Примечание: `black` и `flake8` будут установлены автоматически самим `pre-commit` в изолированное окружение, их глобальная установка не обязательна.*

2.  **Активируйте хуки в репозитории:**
    Находясь в корневой папке проекта, выполните команду:
    ```bash
    pre-commit install
    ```
    Эта команда установит Git-хуки в вашу локальную папку `.git`.

Теперь, при каждой попытке выполнить `git commit`, `pre-commit` сначала запустит `black` для автоматического форматирования ваших `.py` файлов, а затем `flake8` для проверки на наличие ошибок. Если `black` изменит файлы, вам нужно будет снова их добавить (`git add .`) и повторить коммит. Если `flake8` найдет ошибки, коммит будет отклонен до тех пор, пока вы их не исправите.

## Проверка работы

После выполнения всех шагов проект будет полностью готов к работе.

*   **Веб-сервер Django** будет доступен по адресу `http://localhost:8000/`.
*   **Админ-панель Django** доступна по адресу `http://localhost:8000/admin/`. Используйте логин и пароль суперпользователя для входа.
*   **Интерактивная API документация (Swagger UI)** доступна по адресу `http://localhost:8000/api/docs/`. Это основная точка входа для изучения и тестирования API.

## Полезные команды

*   **Остановить проект:**
    ```bash
    docker-compose down
    ```
*   **Остановить проект и удалить данные БД (полный сброс):**
    ```bash
    docker-compose down -v
    ```
*   **Выполнить любую manage.py команду:**
    ```bash
    docker-compose exec web python manage.py <ваша_команда>
    ```
*   **Посмотреть логи запущенных контейнеров:**
    ```bash
    docker-compose logs -f
    ```
